

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Effects &mdash; Herculeum 0.9 documentation</title>
    
    <link rel="stylesheet" href="_static/default.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '',
        VERSION:     '0.9',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <link rel="top" title="Herculeum 0.9 documentation" href="index.html" />
    <link rel="next" title="Configuration" href="configuration.html" />
    <link rel="prev" title="Events" href="events.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="configuration.html" title="Configuration"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="events.html" title="Events"
             accesskey="P">previous</a> |</li>
        <li><a href="index.html">Herculeum 0.9 documentation</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="effects">
<h1>Effects<a class="headerlink" href="#effects" title="Permalink to this headline">¶</a></h1>
<p>This section will have a look at effects, how they are created and handled
during the play and how to add new effects.</p>
<div class="section" id="overview-of-effects-system">
<h2>Overview of effects system<a class="headerlink" href="#overview-of-effects-system" title="Permalink to this headline">¶</a></h2>
<p>Effects can be understood as on-going statuses that have an effect to an
character. Good example would be poisoning. When character has poison effect
active, he periodically takes small amount of damage, until the effect is
removed or it expires.</p>
<p>Both items and characters can cause effects. Spider can cause poisoning and
healing potion can grant healing.</p>
</div>
<div class="section" id="effect-handles">
<h2>Effect handles<a class="headerlink" href="#effect-handles" title="Permalink to this headline">¶</a></h2>
<p><a class="reference internal" href="pyherc/data/effects/module_effect.html#pyherc.data.effects.effect.EffectHandle" title="pyherc.data.effects.effect.EffectHandle"><tt class="xref py py-class docutils literal"><span class="pre">pyherc.data.effects.effect.EffectHandle</span></tt></a> are sort of prototypes for
effects. They contain information on when to trigger the effect, name of the
effect, possible overriding parameters and amount of charges.</p>
</div>
<div class="section" id="effect">
<h2>Effect<a class="headerlink" href="#effect" title="Permalink to this headline">¶</a></h2>
<p><a class="reference internal" href="pyherc/data/effects/module_effect.html#pyherc.data.effects.effect.Effect" title="pyherc.data.effects.effect.Effect"><tt class="xref py py-class docutils literal"><span class="pre">pyherc.data.effects.effect.Effect</span></tt></a> is a baseclass for all effects.
All effects have duration, frequency and tick. Duration tells how long it takes
until effect naturally expires. Frequency tells how often effect is triggered
and tick is internal counter which keeps track when effect should trigger.</p>
<p>When creating a new effect, subclass Effect class and define method:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">def</span> <span class="nf">do_trigger</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</pre></div>
</div>
<p>Do trigger method is automatically triggered when effect&#8217;s internal counter
reaches zero. After the method has been executed, counter will be reset if the
effect has not been expired.</p>
</div>
<div class="section" id="effectsfactory">
<h2>EffectsFactory<a class="headerlink" href="#effectsfactory" title="Permalink to this headline">¶</a></h2>
<p>Effects are cread by <a class="reference internal" href="pyherc/generators/module_effects.html#pyherc.generators.effects.EffectsFactory" title="pyherc.generators.effects.EffectsFactory"><tt class="xref py py-class docutils literal"><span class="pre">pyherc.generators.effects.EffectsFactory</span></tt></a>. It can
take EffectHandle, some parameters and create a correctly instantiated Effect.</p>
<p>EffectsFactory is configured during the start up of the system with information
that links names of effects to concrete Effect subclasses and their parameters.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">pyherc.generators</span> <span class="kn">import</span> <span class="n">EffectsFactory</span>
<span class="kn">from</span> <span class="nn">pyherc.data.effects</span> <span class="kn">import</span> <span class="n">Poison</span>
<span class="kn">from</span> <span class="nn">pyherc.test.cutesy.dictionary</span> <span class="kn">import</span> <span class="n">Adventurer</span>
<span class="kn">from</span> <span class="nn">pyherc.rules</span> <span class="kn">import</span> <span class="n">Dying</span>

<span class="n">effect_factory</span> <span class="o">=</span> <span class="n">EffectsFactory</span><span class="p">()</span>
<span class="n">effect_factory</span><span class="o">.</span><span class="n">add_effect</span><span class="p">(</span><span class="s">&#39;minor poison&#39;</span><span class="p">,</span>
                                    <span class="p">{</span><span class="s">&#39;type&#39;</span><span class="p">:</span> <span class="n">Poison</span><span class="p">,</span>
                                    <span class="s">&#39;duration&#39;</span><span class="p">:</span> <span class="mi">240</span><span class="p">,</span>
                                    <span class="s">&#39;frequency&#39;</span><span class="p">:</span> <span class="mi">60</span><span class="p">,</span>
                                    <span class="s">&#39;tick&#39;</span><span class="p">:</span> <span class="mi">60</span><span class="p">,</span>
                                    <span class="s">&#39;damage&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
                                    <span class="s">&#39;icon&#39;</span><span class="p">:</span> <span class="mi">101</span><span class="p">,</span>
                                    <span class="s">&#39;title&#39;</span><span class="p">:</span> <span class="s">&#39;Minor poison&#39;</span><span class="p">,</span>
                                    <span class="s">&#39;description&#39;</span><span class="p">:</span> <span class="s">&#39;Causes minor amount of damage&#39;</span><span class="p">})</span>

<span class="n">Pete</span> <span class="o">=</span> <span class="n">Adventurer</span><span class="p">()</span>
<span class="k">print</span><span class="p">(</span><span class="s">&#39;Hit points before poisoning: {0}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">Pete</span><span class="o">.</span><span class="n">hit_points</span><span class="p">))</span>

<span class="n">poisoning</span> <span class="o">=</span> <span class="n">effect_factory</span><span class="o">.</span><span class="n">create_effect</span><span class="p">(</span><span class="s">&#39;minor poison&#39;</span><span class="p">,</span> <span class="n">target</span> <span class="o">=</span> <span class="n">Pete</span><span class="p">)</span>
<span class="n">poisoning</span><span class="o">.</span><span class="n">trigger</span><span class="p">(</span><span class="n">Dying</span><span class="p">())</span>

<span class="k">print</span><span class="p">(</span><span class="s">&#39;Hit points after poisoning: {0}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">Pete</span><span class="o">.</span><span class="n">hit_points</span><span class="p">))</span>
</pre></div>
</div>
<p>Pete the adventurer gets affected by minor poison and as a result loses
1 hit point.</p>
<div class="highlight-none"><div class="highlight"><pre>Hit points before poisoning: 10
Hit points after poisoning: 9
</pre></div>
</div>
<p>Note how the effect factory has been supplied by a dictionary of parameters.
These are matched to the constructor of class specified by &#8216;type&#8217; key. All
parameters that are present in the constructor, but are not present in the
dictionary needs to be supplied when effect factory creates a new effect
instance. In our example there was only single parameter like this, the target
of poisoning.</p>
<p>It is also possible to supply parameters during call that have been specified
in the dictionary. These parameters are then used to override the default ones.</p>
</div>
<div class="section" id="effects-collection">
<h2>Effects collection<a class="headerlink" href="#effects-collection" title="Permalink to this headline">¶</a></h2>
<p><a class="reference internal" href="pyherc/data/effects/module_effectscollection.html#pyherc.data.effects.effectscollection.EffectsCollection" title="pyherc.data.effects.effectscollection.EffectsCollection"><tt class="xref py py-class docutils literal"><span class="pre">pyherc.data.effects.effectscollection.EffectsCollection</span></tt></a> is tasked to
keep track of effects and effect handles for particular object. Both Item and
Character objects use it to interact with effects sub system.</p>
<p>Following example creates an EffectHandle and adds it to the collection.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">pyherc.data.effects</span> <span class="kn">import</span> <span class="n">EffectsCollection</span><span class="p">,</span><span class="n">EffectHandle</span>

<span class="n">collection</span> <span class="o">=</span> <span class="n">EffectsCollection</span><span class="p">()</span>
<span class="n">handle</span> <span class="o">=</span> <span class="n">EffectHandle</span><span class="p">(</span><span class="n">trigger</span> <span class="o">=</span> <span class="s">&#39;on kick&#39;</span><span class="p">,</span>
                      <span class="n">effect</span> <span class="o">=</span> <span class="s">&#39;explosion&#39;</span><span class="p">,</span>
                      <span class="n">parameters</span> <span class="o">=</span> <span class="bp">None</span><span class="p">,</span>
                      <span class="n">charges</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">collection</span><span class="o">.</span><span class="n">add_effect_handle</span><span class="p">(</span><span class="n">handle</span><span class="p">)</span>

<span class="k">print</span> <span class="n">collection</span><span class="o">.</span><span class="n">get_effect_handles</span><span class="p">()</span>
</pre></div>
</div>
<p>The collection now contains a single EffectHandle object.</p>
<div class="highlight-none"><div class="highlight"><pre>[&lt;pyherc.data.effects.effect.EffectHandle object at 0x...&gt;]
</pre></div>
</div>
<p>Following example creates an Effect and adds it to the collection.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">pyherc.data.effects</span> <span class="kn">import</span> <span class="n">EffectsCollection</span><span class="p">,</span> <span class="n">Poison</span>

<span class="n">collection</span> <span class="o">=</span> <span class="n">EffectsCollection</span><span class="p">()</span>
<span class="n">effect</span> <span class="o">=</span> <span class="n">Poison</span><span class="p">(</span><span class="n">duration</span> <span class="o">=</span> <span class="mi">200</span><span class="p">,</span>
                <span class="n">frequency</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span>
                <span class="n">tick</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
                <span class="n">damage</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
                <span class="n">target</span> <span class="o">=</span> <span class="bp">None</span><span class="p">,</span>
                <span class="n">icon</span> <span class="o">=</span> <span class="mi">101</span><span class="p">,</span>
                <span class="n">title</span> <span class="o">=</span> <span class="s">&#39;minor poison&#39;</span><span class="p">,</span>
                <span class="n">description</span> <span class="o">=</span> <span class="s">&#39;Causes small amount of damage&#39;</span><span class="p">)</span>
<span class="n">collection</span><span class="o">.</span><span class="n">add_effect</span><span class="p">(</span><span class="n">effect</span><span class="p">)</span>

<span class="k">print</span> <span class="n">collection</span><span class="o">.</span><span class="n">get_effects</span><span class="p">()</span>
</pre></div>
</div>
<p>The collection now contains a single Poison object.</p>
<div class="highlight-none"><div class="highlight"><pre>[&lt;pyherc.data.effects.poison.Poison object at 0x...&gt;]
</pre></div>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
  <h3><a href="index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Effects</a><ul>
<li><a class="reference internal" href="#overview-of-effects-system">Overview of effects system</a></li>
<li><a class="reference internal" href="#effect-handles">Effect handles</a></li>
<li><a class="reference internal" href="#effect">Effect</a></li>
<li><a class="reference internal" href="#effectsfactory">EffectsFactory</a></li>
<li><a class="reference internal" href="#effects-collection">Effects collection</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="events.html"
                        title="previous chapter">Events</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="configuration.html"
                        title="next chapter">Configuration</a></p>
  <h3>This Page</h3>
  <ul class="this-page-menu">
    <li><a href="_sources/effects.txt"
           rel="nofollow">Show Source</a></li>
  </ul>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="configuration.html" title="Configuration"
             >next</a> |</li>
        <li class="right" >
          <a href="events.html" title="Events"
             >previous</a> |</li>
        <li><a href="index.html">Herculeum 0.9 documentation</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2010-2013, Tuukka Turto.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.1.3.
    </div>
  </body>
</html>